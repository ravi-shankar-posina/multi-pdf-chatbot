*&---------------------------------------------------------------------*
*&  Include           ZNMM_MARC_GR_PROCESS_TOP
*&---------------------------------------------------------------------*
*07/06/2024 CHG2068956 DE3K9A0RJS RITM7539793 Adjust the code to improve
*                                the performance of reprocessing program.
*----------------------------------------------------------------------*

*TABLES: somlreci1.   "SAPoffice: Structure of the API Recipient List
** Types declaration
TYPES: BEGIN OF TY_ALV_DATA,
         SEL,
         FILE_NAME      TYPE LOCALFILE,
         COMP_CODE      TYPE ZCOMP_CODE,
         TRAN_SEQ_NO    TYPE ZTRAN_SEQ_NO,
         PO_NO          TYPE ZPO_NO,
         RECORD_SQN     TYPE ZRECORD_SEQ_NO,
         REC_TYPE       TYPE ZREC_TYPE,
         PROCESS_STATUS TYPE CHAR1,
       END OF TY_ALV_DATA.
TYPES: BEGIN OF TYP_INPUT,
         RECORD_ID TYPE CHAR4,
         DATA      TYPE STRING,
       END OF TYP_INPUT,
       BEGIN OF TYP_ERROR_FILE,
         TRAN_SEQ_NO(9)     TYPE  C,
         COMP_CODE(2)       TYPE C,
         PO_NO(15)           TYPE C,
         PO_LINE_NO(6)      TYPE C,
         SKU(20)            TYPE C,
         QTY_EXPE(9)        TYPE C,
         CART_LP(9)         TYPE C,
         LP(9)              TYPE C,
         RECORD_DATE(8)     TYPE C,
         RECORD_TIME(6)     TYPE C,
         REJECT_REASON(125) TYPE C,
       END OF TYP_ERROR_FILE.

TYPES:  BEGIN OF TYP_SMF.
          INCLUDE STRUCTURE ZSMM_MARC_GR_ME.
        TYPES: END OF TYP_SMF.
TYPES : BEGIN OF TYP_LIKP,
          VBELN TYPE VBELN_VL,
          LFART TYPE LFART,
          LIFNR TYPE ELIFN,
          LIFEX TYPE LIFEX,
        END OF TYP_LIKP,
        BEGIN OF TYP_LIPS,
          VBELN TYPE VBELN_VL,
          POSNR TYPE POSNR_VL,
          MATNR TYPE MATNR,
          LFIMG TYPE LFIMG,
        END OF TYP_LIPS,
        BEGIN OF TYP_LFA1,
          LIFNR TYPE LIFNR,
          NAME1 TYPE NAME1_GP,
          KTOKK TYPE KTOKK,
          WERKS TYPE WERKS_EXT,
        END OF TYP_LFA1,
        BEGIN OF TYP_VBFA,
          VBELV   TYPE VBELN_VON,
          POSNV   TYPE POSNR_VON,
          VBELN   TYPE VBELN_NACH,
          POSNN   TYPE POSNR_NACH,
          VBTYP_N TYPE VBTYP_N,
          RFMNG   TYPE RFMNG,
          VBTYP_V TYPE VBTYP_V,
          PLMIN   TYPE PLMIN,
          BWART   TYPE BWART,
          MJAHR   TYPE MJAHR,
        END OF TYP_VBFA,
        BEGIN OF TYP_LIPS1,
          VBELN TYPE LIPS-VBELN,
          POSNR TYPE LIPS-POSNR,
          MATNR TYPE LIPS-MATNR,
          WERKS TYPE LIPS-WERKS,
          LGORT TYPE LGORT_D,
          CHARG TYPE CHARG_D,
          LFIMG TYPE LIPS-LFIMG,
          MEINS TYPE LIPS-MEINS,
          VRKME TYPE VRKME,
          UMVKZ TYPE UMVKZ,
          UMVKN TYPE UMVKN,
          VGBEL TYPE LIPS-VGBEL,
          VGPOS TYPE LIPS-VGPOS,
          XCHPF TYPE XCHPF,
          UMREF TYPE UMREFF,
          UECHA TYPE UECHA,
          INSMK TYPE LIPS-INSMK,
          ORMNG TYPE LIPS-ORMNG,
        END OF TYP_LIPS1,
        BEGIN OF TYP_LIPS_SPLIT,
          VBELN TYPE LIPS-VBELN,
          POSNR TYPE LIPS-POSNR,
          MATNR TYPE LIPS-MATNR,
          WERKS TYPE LIPS-WERKS,
          CHARG TYPE CHARG_D,
          LFIMG TYPE LIPS-LFIMG,
          MEINS TYPE LIPS-MEINS,
          UMVKZ TYPE UMVKZ,
          UMVKN TYPE UMVKN,
        END OF TYP_LIPS_SPLIT,
        BEGIN OF TYP_TBTCO,
          JOBNAME	 TYPE BTCJOB,
          JOBCOUNT TYPE	BTCJOBCNT,
          STRTDATE TYPE BTCXDATE,
          STRTTIME TYPE BTCXTIME,
          ENDDATE	 TYPE BTCXDATE,
          ENDTIME	 TYPE BTCXTIME,
        END OF TYP_TBTCO,
        BEGIN OF TYP_VBUK,
          VBELN TYPE VBELN,
          KOSTK TYPE KOSTK,
        END OF TYP_VBUK.
** Table types declaration
TYPES: TTY_GR_RECH TYPE TABLE OF ZTMM_MARC_GR_H,
       TTY_GR_RECL TYPE TABLE OF ZTMM_MARC_GR_L.
**Global Data declarations
DATA: GT_ZTUHCD1                   TYPE STANDARD TABLE OF ZTUHCD1,
      GI_ZTUHCD1                   TYPE ZTUHCD1,
      GT_GR_RECH                   TYPE STANDARD TABLE OF ZTMM_MARC_GR_H,
      GT_GR_RECH_MAIN              TYPE STANDARD TABLE OF ZTMM_MARC_GR_H,
      GI_GR_RECH                   TYPE ZTMM_MARC_GR_H,
      GT_GR_RECL                   TYPE STANDARD TABLE OF ZTMM_MARC_GR_L,
      GT_GR_RECL_MAIN              TYPE STANDARD TABLE OF ZTMM_MARC_GR_L,
      GI_GR_RECL                   TYPE ZTMM_MARC_GR_L,
      GT_ALV_DATA                  TYPE STANDARD TABLE OF TY_ALV_DATA,
      GI_ALV_DATA                  TYPE TY_ALV_DATA,
      GT_FCAT                      TYPE SLIS_T_FIELDCAT_ALV WITH HEADER LINE,
      GI_FCAT                      LIKE LINE OF GT_FCAT,
      GV_RECTYPE                   TYPE ZREC_TYPE,
      GV_TRAN_SEQ                  TYPE ZTRAN_SEQ_NO,
      GV_PROD_STATUS               TYPE ZPROD_STAT,
*      gv_fail_step TYPE char3,
      GV_FSTEP                     TYPE CHAR3,
      GV_PROCESS_STATUS            TYPE CHAR1,
      GV_BATCH                     TYPE CHAR1,
      GV_OVERAGE                   TYPE CHAR1,
      GV_LINKED_SURP               TYPE CHAR1,
      GI_BAPI_GM_ITEM              TYPE BAPI2017_GM_ITEM_CREATE,
      GT_BAPI_GM_ITEM              TYPE STANDARD TABLE OF BAPI2017_GM_ITEM_CREATE,
      GW_RESULT                    TYPE CHAR1,
      GW_REJECT_REASON             TYPE ZREJECT_REASON,
      GW_MBLNR                     TYPE BAPI2017_GM_HEAD_RET-MAT_DOC,
      GW_MJAHR                     TYPE BAPI2017_GM_HEAD_RET-DOC_YEAR,
      GW_MBLNR_SH                  TYPE BAPI2017_GM_HEAD_RET-MAT_DOC,
      GW_MJAHR_SH                  TYPE BAPI2017_GM_HEAD_RET-DOC_YEAR,
*      gw_rec_type      TYPE char2,
      GW_PROD_STAT                 TYPE CHAR2,
      GW_FILE_PATH                 TYPE STRING,
      GW_ARC_FILE_PATH             TYPE STRING,
      GW_SOURCE_PATH               TYPE SAPB-SAPPFAD,
      GW_TARGET_PATH               TYPE SAPB-SAPPFAD,
      GW_TRAN_NO_TAB               TYPE ZTRAN_NO,
      GW_HEADER_TXT                TYPE BKTXT,
      GW_TRANS_SEQ_NO_TAB          TYPE ZTRAN_SEQ_NO,
      GW_DATA_TYPE_TAB             TYPE ZDATA_TYPE,
      GW_COMP_CODE_TAB             TYPE ZCOMP_CODE,
      GW_PO_NO_TAB                 TYPE ZPO_NO,
      GW_PO_LINE_NO_TAB            TYPE ZPO_LINE_NO,
      GW_PO_LINE_NO(6)             TYPE C,
      GW_SKU_TAB                   TYPE ZSKU,
      GW_QTY_EXPE_TAB              TYPE ZQTY_EXPE,
      GW_QTY_EXPE(9)               TYPE C,
      GW_PRE_PO_NO_TAB             TYPE ZPO_NO,
      GW_NO_HDR_RECORDS_TAB        TYPE ZNO_HDR_RECORDS,
      GW_NO_DETAIL_RECORDS_TAB     TYPE ZNO_DETAIL_RECORDS,
      GW_NO_DETAIL_REC_PROCESS_TAB TYPE ZNO_DETAIL_RECORDS,
      GW_MAT_DOC_TAB               TYPE MBLNR,
      GW_INPUT_STATUS_TAB          TYPE ZINPUT_STATUS,
      GW_ERROR_TYPE_TAB            TYPE ZERROR_TYPE,
      GW_REJECT_REASON_TAB         TYPE ZREJECT_REASON,
      GW_UOM_ABBREV                TYPE ZUOM_ABBREV,
      GW_UOM(2)                    TYPE C,
      GW_LOT                       TYPE ZLOT,
      GW_LP                        TYPE ZLP,
      GW_LP_TAB                    TYPE ZLP,
      GW_CART_LP                   TYPE ZCART_LP,
      GW_CART_LP_TAB               TYPE ZCART_LP,
      GW_MESSAGE                   TYPE BAPI_MSG,
      GW_MESSAGE_SH                TYPE BAPI_MSG,
      GW_ERR_CNT                   TYPE I,
      GW_SEQ_NO                    TYPE I,
      GW_SEQ_NO_TEMP               TYPE I,
      GW_SEQ_NO_CUS                TYPE I,
      GW_BAPI_ERROR(23)            TYPE C,
      GW_BAPI_ERROR_SH(23)         TYPE C,
      GW_SAP_ERROR_FLAG(1)         TYPE C,
      GW_SAP_ERROR_SH_FLAG(1)      TYPE C,
      GW_FMNAME                    TYPE RS38L_FNAM,
      GI_SSFCTRLOP                 TYPE SSFCTRLOP,
      GI_SSFCOMPOP                 TYPE SSFCOMPOP,
      GI_SSFCRESCL                 TYPE SSFCRESCL,
      GT_OTF                       TYPE STANDARD TABLE OF ITCOO,
      GT_TLINE                     TYPE STANDARD TABLE OF TLINE,
      GT_OBJTXT                    TYPE STANDARD TABLE OF SOLISTI1,
      GT_OBJBIN                    TYPE STANDARD TABLE OF SOLIX,
      GI_OBJHEAD                   TYPE SOLI_TAB,
      GW_BUFFER                    TYPE STRING,
      GI_TLINE                     TYPE TLINE,
      GI_RECORD                    TYPE SOLISTI1,
      GI_OBJBIN                    TYPE SOLIX,
      GV_LEN_IN                    TYPE I,
      GI_XSTRING                   TYPE XSTRING,
      GW_VBELN                     TYPE VBELN_VL,
      GW_LIFEX                     TYPE LIFEX,
      GW_DTYPE                     TYPE ZDATA_TYPE,
      GW_TSEQNO                    TYPE ZTRAN_SEQ_NO,
      GW_FNAME                     TYPE LOCALFILE,
      GW_CCODE                     TYPE ZCOMP_CODE,
      GW_NTYPE                     TYPE DD01V-DATATYPE,
      GW_VALUE                     TYPE STRING,
      GW_REC_ERROR                 TYPE CHAR1,
      GW_TEST                      TYPE CHAR1,
      GW_LINE_COUNT                TYPE I,
      GW_PRE_LINE_NO               TYPE ZPO_LINE_NO,
      GW_VENDOR                    TYPE XBLNR,
      GW_POS_QTY                   TYPE RFMNG,
      GW_NEV_QTY                   TYPE RFMNG,
      GW_GR_QTY                    TYPE RFMNG,
      GW_GR_OPEN_QTY               TYPE RFMNG,
      GW_GR_101_QTY                TYPE ERFMG,
      GW_GR_701_QTY                TYPE ERFMG,
      GW_GR_MAIN_QTY               TYPE ERFMG,
      GW_GR_CHILD_QTY              TYPE ERFMG,
      GW_GR_FULL_QTY               TYPE ERFMG,
      GW_GR_LINE_QTY               TYPE ERFMG,
      GW_MSG_ID                    TYPE SYMSGID,
      GW_MSG_NO                    TYPE SYMSGNO,
      GW_MATNR                     TYPE MATNR,
      GW_ZZALTMN                   TYPE ZALTMN,
      GW_FLAG                      TYPE CHAR1,
      GW_STRLN                     TYPE I,
      GW_SWITCH                    TYPE CHAR3,
      GW_OLD_DELI                  TYPE BAPIOBDLVHDRDSP-DELIVERY,
      GW_NEW_DELI                  TYPE BAPIOBDLVHDRDSP-DELIVERYNEW,
      GW_OBD_MAIN_QTY              TYPE ERFMG,
      GW_OBD_CHILD_QTY             TYPE ERFMG,
      GW_OBD_FULL_QTY              TYPE ERFMG,
      GW_OBD_LINE_QTY              TYPE ERFMG,
      GW_CUS_RET_ERROR             TYPE CHAR1,
      GW_OBD_FLAG                  TYPE CHAR1,
      GW_SPLIT_FLAG                TYPE CHAR1,
      GW_DELETE_FLAG               TYPE CHAR1,
      GW_PICK_FLAG                 TYPE CHAR1,
      GW_PGI_FLAG                  TYPE CHAR1,
      GW_INSP_FLAG                 TYPE CHAR1,
      GW_GOODS_FLAG                TYPE CHAR1,
      GW_BATCH_FLAG                TYPE CHAR1,
      GW_PROCESS_STATUS            TYPE  ZPROCESSING_STATUS,
      GW_FAIL_STEP                 TYPE  ZFAIL_STEP_NO,
      GW_FAIL_STEP_NO              TYPE  ZFAIL_STEP_NO,
      GW_FAIL_STEP_DESC            TYPE  ZFAIL_STEP_DESCRIPTION,
      GW_REASON                    TYPE  ZFAIL_REASON,
      GW_STATUS                    TYPE  ZDEL_STATUS,
      GW_SPLIT_DEL_NO              TYPE  VBELN_VL,
      GW_SPLIT_DEL_LINE_NO         TYPE POSNR_VL,
      GW_SPLIT_DEL_QTY             TYPE LFIMG,
      GW_INSP_NO                   TYPE /SPE/INSPEC_NO,
      GW_PGI_GR_NO                 TYPE VBELN_NACH,
      GW_PGI_GR_LINE_NO            TYPE  POSNR_NACH,
      GW_PGI_GR_QTY                TYPE  RFMNG,
      GW_PGI_GR_YEAR               TYPE MJAHR,
      GW_PGI_MOVE_TYPE             TYPE BWART,
      GW_GR_NO                     TYPE  MBLNR,
      GW_GR_YEAR                   TYPE  MJAHR,
      GW_GR_LINE_NO                TYPE  MBLPO,
      GW_GR_QTY_CUS                TYPE  MENGE_D,
      GW_GR_MOVE_TYPE              TYPE  BWART,
      GW_INSP_CODE                 TYPE MSR_INSPECTION_CODE,
      GW_FOLLOWUP_ACT              TYPE MSR_FU_CODE,
      GI_BAPI_GM_HEAD              TYPE BAPI2017_GM_HEAD_01,
      GI_BAPI_GM_CODE              TYPE BAPI2017_GM_CODE,
      GW_TESTRUN                   TYPE BAPI2017_GM_GEN-TESTRUN,
      GT_BAPI_RETURN               TYPE STANDARD TABLE OF BAPIRET2,
      GI_BAPI_RETURN               TYPE BAPIRET2,
      GI_BAPI_GM_HEAD_SH           TYPE BAPI2017_GM_HEAD_01,
      GI_BAPI_GM_CODE_SH           TYPE BAPI2017_GM_CODE,
      GW_TESTRUN_SH                TYPE BAPI2017_GM_GEN-TESTRUN,
      GI_BAPI_GM_ITEM_SH           TYPE BAPI2017_GM_ITEM_CREATE,
      GT_BAPI_GM_ITEM_SH           TYPE STANDARD TABLE OF BAPI2017_GM_ITEM_CREATE,
      GT_BAPI_RETURN_SH            TYPE STANDARD TABLE OF BAPIRET2,
      GI_BAPI_RETURN_SH            TYPE BAPIRET2,
      GT_INPUT_DATA                TYPE STANDARD TABLE OF TYP_INPUT,
      GI_INPUT_DATA                TYPE TYP_INPUT,
      GT_DIR_LIST                  TYPE STANDARD TABLE OF EPS2FILI,
      GI_DIR_LIST                  TYPE EPS2FILI,
      GI_ZTMM_MARC_TRANS           TYPE ZTMM_MARC_GR_TR,
      GT_ZTMM_MARC_TRANS           TYPE STANDARD TABLE OF ZTMM_MARC_GR_TR,
      GT_ZTMM_MARC_FILE            TYPE STANDARD TABLE OF ZTMM_MARC_GR_FL,
      GT_GR_MARC_FL                TYPE STANDARD TABLE OF ZTMM_MARC_GR_FL,
      GT_ZTMM_MARC_GR_ERR          TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GT_MARC_GR_ITEM              TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GT_MARC_OVG_ITEM             TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GT_MARC_SUP_ITEM             TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GT_MARC_SPLIT_ITEM           TYPE STANDARD TABLE OF ZTMM_MARC_GR_CUS, "ztmm_marc_gr_er,
      GT_MARC_SPLIT_ITEM1          TYPE STANDARD TABLE OF ZTMM_MARC_GR_CUS,
      GT_GR_MARC_ER                TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GI_ZTMM_MARC_FILE            TYPE ZTMM_MARC_GR_FL,
      GI_GR_MARC_FL                TYPE ZTMM_MARC_GR_FL,
      GI_ZTMM_MARC_GR_ERR          TYPE ZTMM_MARC_GR_ER,
      GI_MARC_GR_ITEM              TYPE ZTMM_MARC_GR_ER,
      GI_MARC_OVG_ITEM             TYPE ZTMM_MARC_GR_ER,
      GI_MARC_SUP_ITEM             TYPE ZTMM_MARC_GR_ER,
      GI_MARC_SPLIT_ITEM           TYPE ZTMM_MARC_GR_CUS, "ztmm_marc_gr_er,
      GI_MARC_SPLIT_ITEM1          TYPE ZTMM_MARC_GR_CUS,
      GI_GR_MARC_ER                TYPE ZTMM_MARC_GR_ER,
      GT_ERROR_FILE                TYPE STANDARD TABLE OF TYP_ERROR_FILE,
      GI_ERROR_FILE                TYPE TYP_ERROR_FILE,
      GT_ERROR_MARC                TYPE STANDARD TABLE OF ZTMM_MARC_GR_ME,
      GT_ERROR_MARC_SMF            TYPE STANDARD TABLE OF TYP_SMF,
      GI_ERROR_MARC_SMF            TYPE TYP_SMF,
      GI_ERROR_MARC                TYPE ZTMM_MARC_GR_ME,
      GT_MARC_GR_EF                TYPE STANDARD TABLE OF ZTMM_MARC_GR_EF,
      GI_MARC_GR_EF                TYPE ZTMM_MARC_GR_EF,
      GI_MARC_PRINT                TYPE ZTMM_MARC_PRINT,
      GT_SAP_ERR                   TYPE STANDARD TABLE OF ZTMM_MARC_GR_ER,
      GI_SAP_ERR                   TYPE ZTMM_MARC_GR_ER,
      GV_EMAIL                     TYPE ADR6-SMTP_ADDR,
      GT_LIKP                      TYPE STANDARD TABLE OF TYP_LIKP,
      GI_LIKP                      TYPE TYP_LIKP,
      GT_LIPS                      TYPE STANDARD TABLE OF TYP_LIPS,
      GI_LIPS                      TYPE TYP_LIPS,
      GT_LFA1                      TYPE STANDARD TABLE OF TYP_LFA1,
      GI_LFA1                      TYPE TYP_LFA1,
      GT_VBFA                      TYPE STANDARD TABLE OF TYP_VBFA,
      GI_VBFA                      TYPE TYP_VBFA,
      GI_VBFA_PGI                  TYPE TYP_VBFA,
      GT_LIPS1                     TYPE STANDARD TABLE OF TYP_LIPS1,
      GI_LIPS1                     TYPE TYP_LIPS1,
      GI_LIPS1_TMP                 TYPE TYP_LIPS1,
      GI_LIPS_SPLIT                TYPE TYP_LIPS_SPLIT,
      GI_LIPS_DELETE               TYPE TYP_LIPS_SPLIT,
      GI_HEADER_DATA               TYPE BAPIIBDLVHDRCHG,
      GI_HEADER_CONTROL            TYPE BAPIIBDLVHDRCTRLCHG,
      GW_DELIVERY                  TYPE BAPIIBDLVHDRCHG-DELIV_NUMB,
      GI_ITEM_DATA                 TYPE BAPIIBDLVITEMCHG,
      GI_ITEM_CONTROL              TYPE BAPIIBDLVITEMCTRLCHG,
      GI_RETURN                    TYPE BAPIRET2,
      GT_ITEM_DATA                 TYPE STANDARD TABLE OF BAPIIBDLVITEMCHG,
      GT_ITEM_CONTROL              TYPE STANDARD TABLE OF BAPIIBDLVITEMCTRLCHG,
      GT_RETURN                    TYPE STANDARD TABLE OF BAPIRET2,
      GT_TBTCO                     TYPE STANDARD TABLE OF TYP_TBTCO,
      GI_TBTCO                     TYPE TYP_TBTCO,
      GI_ZTMM_MARC_GR_CUS          TYPE ZTMM_MARC_GR_CUS,
      GT_ZTMM_MARC_GR_CUS          TYPE STANDARD TABLE OF ZTMM_MARC_GR_CUS,
      GT_SPLIT_ITEMDATA            TYPE STANDARD TABLE OF  BAPIOBDLVITEMDSP,
      GI_SPLIT_ITEMDATA            TYPE  BAPIOBDLVITEMDSP,
      GT_SPLIT_RETURN              TYPE STANDARD TABLE OF BAPIRET2,
      GI_SPLIT_RETURN              TYPE BAPIRET2,
      GI_VBKOK_WA                  TYPE VBKOK,
      GT_VBPOK_TAB                 TYPE STANDARD TABLE OF VBPOK,
      GI_VBPOK_TAB                 TYPE VBPOK,
      GI_PGI_HEADER_DATA           TYPE BAPIOBDLVHDRCON,
      GI_PGI_HEADER_CONTROL        TYPE BAPIOBDLVHDRCTRLCON,
      GI_PGI_DELIVERY              TYPE VBELN_VL,
      GT_PGI_RETURN                TYPE STANDARD TABLE OF BAPIRET2,
      GI_PGI_RETURN                TYPE BAPIRET2,
      GT_INSP_DATA                 TYPE STANDARD TABLE OF MSR_S_INSP_LFU_DATA_EXTERNAL,
      GI_INSP_DATA                 TYPE MSR_S_INSP_LFU_DATA_EXTERNAL,
      GI_LONGTEXT                  TYPE MSR_S_INSP_COMMENT,
      GT_INSP_RETURN               TYPE STANDARD TABLE OF BAPIRET2,
      GI_INSP_RETURN               TYPE BAPIRET2,
      GI_OBD_HEADER_DATA           TYPE BAPIOBDLVHDRCHG,
      GI_OBD_HEADER_CONTROL        TYPE BAPIOBDLVHDRCTRLCHG,
      GW_OBD_DELIVERY              TYPE BAPIOBDLVHDRCHG-DELIV_NUMB,
      GT_OBD_ITEM_DATA             TYPE STANDARD TABLE OF BAPIOBDLVITEMCHG,
      GI_OBD_ITEM_DATA             TYPE BAPIOBDLVITEMCHG,
      GT_OBD_ITEM_CONTROL          TYPE STANDARD TABLE OF BAPIOBDLVITEMCTRLCHG,
      GI_OBD_ITEM_CONTROL          TYPE BAPIOBDLVITEMCTRLCHG,
      GT_OBD_RETURN                TYPE STANDARD TABLE OF BAPIRET2,
      GI_OBD_RETURN                TYPE BAPIRET2,
      GI_DEL_HEADER_DATA           TYPE BAPIOBDLVHDRCHG,
      GI_DEL_HEADER_CONTROL        TYPE BAPIOBDLVHDRCTRLCHG,
      GW_DEL_DELIVERY              TYPE BAPIOBDLVHDRCHG-DELIV_NUMB,
      GT_DEL_ITEM_DATA             TYPE STANDARD TABLE OF BAPIOBDLVITEMCHG,
      GI_DEL_ITEM_DATA             TYPE BAPIOBDLVITEMCHG,
      GT_DEL_ITEM_CONTROL          TYPE STANDARD TABLE OF BAPIOBDLVITEMCTRLCHG,
      GI_DEL_ITEM_CONTROL          TYPE BAPIOBDLVITEMCTRLCHG,
      GT_DEL_RETURN                TYPE STANDARD TABLE OF BAPIRET2,
      GI_DEL_RETURN                TYPE BAPIRET2,
      GI_BATCH_HEADER_DATA         TYPE BAPIOBDLVHDRCHG,
      GI_BATCH_HEADER_CONTROL      TYPE BAPIOBDLVHDRCTRLCHG,
      GW_BATCH_DELIVERY            TYPE BAPIOBDLVHDRCHG-DELIV_NUMB,
      GT_BATCH_ITEM_DATA           TYPE STANDARD TABLE OF BAPIOBDLVITEMCHG,
      GI_BATCH_ITEM_DATA           TYPE BAPIOBDLVITEMCHG,
      GT_BATCH_ITEM_CONTROL        TYPE STANDARD TABLE OF BAPIOBDLVITEMCTRLCHG,
      GI_BATCH_ITEM_CONTROL        TYPE BAPIOBDLVITEMCTRLCHG,
      GT_BATCH_RETURN              TYPE STANDARD TABLE OF BAPIRET2,
      GI_BATCH_RETURN              TYPE BAPIRET2,
      GI_BAPI_GM_HEAD_CUS          TYPE BAPI2017_GM_HEAD_01,
      GI_BAPI_GM_CODE_CUS          TYPE BAPI2017_GM_CODE,
      GW_TESTRUN_CUS               TYPE BAPI2017_GM_GEN-TESTRUN,
      GI_BAPI_GM_ITEM_CUS          TYPE BAPI2017_GM_ITEM_CREATE,
      GT_BAPI_GM_ITEM_CUS          TYPE STANDARD TABLE OF BAPI2017_GM_ITEM_CREATE,
      GT_BAPI_RETURN_CUS           TYPE STANDARD TABLE OF BAPIRET2,
      GI_BAPI_RETURN_CUS           TYPE BAPIRET2,
      GI_VBUK                      TYPE TYP_VBUK,
      GW_VSTEL                     TYPE VSTEL,
      GW_LFART                     TYPE LFART,
      GW_WERKS                     TYPE WERKS_D,
      GV_RECH_COUNT                TYPE ZRECORD_SEQ_NO,
      GV_RECL_COUNT                TYPE ZRECORD_SEQ_NO,
      GV_STEP                      TYPE CHAR2,
      GV_STEP_DESCR                TYPE CHAR50,
      GV_STATUS                    TYPE CHAR1,
      GV_TABIX                     TYPE SY-TABIX,
      GT_MARC_MSG_PR               TYPE STANDARD TABLE OF ZTMM_MARC_MSG_PR,
      GI_MARC_MSG_PR               TYPE ZTMM_MARC_MSG_PR,
      GV_CONTINUE                  TYPE CHAR1,
      GV_FOUND                     TYPE CHAR1,
** Begin of changes by USPRADI JE3K904585 on 24.02.2022
      GW_CUST_RET                  TYPE CHAR1.
** End of changes by USPRADI JE3K904585 on 24.02.2022
** Begin of changes by USPRADI JE3K905848 on 15.03.2022
DATA: GV_DEL   TYPE VBELN_VL,
      GV_POSNR TYPE POSNR_VL.
** End of changes by USPRADI JE3K905848 on 15.03.2022
** Begin of changes by USPRADI DE3K9A0CR0 on 12.04.2022
DATA: GV_RECL_SEQ   TYPE ZRECORD_SEQ_NO,
      GV_RECH_SEQ   TYPE ZRECORD_SEQ_NO,
      GV_TEMP_ABLAD TYPE ABLAD.
** End of changes by USPRADI DE3K9A0CR0 on 12.04.2022
  DATA : GW_MARC_PRINT TYPE ZTMM_MARC_PRINT. "USPRADI DE3K9A0DSF 02.06.2022
**Constants declarations
CONSTANTS: GC_NAME     TYPE STRING VALUE 'MARC_INTERFACE',
           GC_FORMNAME TYPE TDSFNAME  VALUE 'ZMM_MARC_GR_ERROR_REPORT_SF',
           GC_PROG     TYPE STRING VALUE 'ZRMM_MARC_GR_PROCESS',
           GC_X        TYPE CHAR1   VALUE 'X',
           GC_TRUE(1)  TYPE C VALUE 'X',
           GC_HTAB     TYPE C VALUE               "For tab
                             CL_ABAP_CHAR_UTILITIES=>HORIZONTAL_TAB,
           GC_CRET     TYPE C VALUE CL_ABAP_CHAR_UTILITIES=>CR_LF,
           GC_NEWLINE  TYPE C VALUE               "For NEW-LINE char.
                      CL_ABAP_CHAR_UTILITIES=>NEWLINE,
           GC_ERROR    TYPE C VALUE 'E'.    "++USRAING DE3K9A0RJS CHG2068956 07.06.2024


** Field Symbols
FIELD-SYMBOLS: <GFS_RECH> TYPE ZTMM_MARC_GR_H,
               <GFS_RECL> TYPE ZTMM_MARC_GR_L.

RANGES: GR_LFART_IBD FOR ZTUHCD1-LOW,
        GR_LFART_OBD FOR ZTUHCD1-LOW.

RANGES: S_RETURN FOR GW_BAPI_ERROR.

