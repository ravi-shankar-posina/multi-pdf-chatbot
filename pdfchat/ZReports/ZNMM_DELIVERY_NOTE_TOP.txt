TYPE-POOLS: slis.
**** local variables for selction screen
DATA : gv_vkorg TYPE  vkorg,
       gv_kunnr TYPE  kunnr,
**** CHG0479115 DE3K941845 modification starts by 502237354 08/07/2014
       gv_vstel TYPE  likp-vstel,
       gv_vsart TYPE  vttk-vsart,"vsarttr,
       gv_vbeln TYPE  likp-vbeln,"vbeln_vl,
**** CHG0479115 DE3K941845 modification ends by 502237354 08/07/2014
       gv_kostk TYPE  kostk,
       gv_wbstk TYPE  wbstk.
************Structure declarations
TYPES:  BEGIN OF ty_vbpa_ds,
          vbeln TYPE vbeln,       "2  Sales and Distribution Document Number
          posnr TYPE posnr,       "3  Item number of the SD document
          parvw	TYPE parvw,       "4  Partner Function
          kunnr TYPE kunnr,       "5  Customer Number
          lifnr TYPE lifnr,       "6  Account Number of Vendor or Creditor
        END OF ty_vbpa_ds,
 BEGIN OF ty_t001_ds,
          bukrs TYPE bukrs,
          butxt TYPE butxt,
          waers TYPE waers,
 END OF ty_t001_ds,
 BEGIN OF ty_lips_ds,
         vbeln TYPE vbeln_vl,
         posnr TYPE posnr_vl,
         vgbel TYPE vgbel,
         vgpos TYPE vgpos,
         lfimg TYPE lfimg,
         erzet TYPE erzet,
         erdat TYPE erdat,
         werks TYPE werks_d,
         netwr TYPE netwr,
  END OF ty_lips_ds,
  BEGIN OF ty_vbap_ds,
       vbeln TYPE vbeln_va,
       posnr TYPE posnr_va,
       netwr TYPE netwr_ap,
       kwmeng TYPE kwmeng,
       waerk TYPE waerk ,
  END OF ty_vbap_ds,
  BEGIN OF ty_vbak_ds,
      vbeln TYPE vbeln_va,
       kunnr TYPE kunnr,
       vkorg TYPE vkorg,
       vtweg TYPE vtweg,
       spart TYPE spart,
       vdatu TYPE edatu_vbak,
    END OF ty_vbak_ds,
 BEGIN OF ty_vbup_ds,
       vbeln TYPE vbeln,
       posnr TYPE posnr,
       koqua TYPE koqua,
       wbsta TYPE wbsta,
       fksta TYPE fksta,
       kosta TYPE kosta,
  END OF ty_vbup_ds,
  BEGIN OF ty_knvv_ds,
       kunnr TYPE kunnr,
       vkorg TYPE vkorg,
       vtweg TYPE vtweg,
       spart TYPE spart,
       ktgrd TYPE ktgrd,
       kvgr3 TYPE kvgr3,
       bzirk TYPE bzirk,
  END OF ty_knvv_ds,
 BEGIN OF ty_vttp_ds,
   vbeln TYPE vbeln_vl,
   tknum TYPE tknum,
 END OF ty_vttp_ds,
 BEGIN OF ty_vttk_ds,
  tknum TYPE tknum,
  vsart TYPE vsarttr,
 END OF ty_vttk_ds,
 BEGIN OF ty_vbuk_ds,
  vbeln TYPE vbeln,
  lvstk TYPE lvstk,
  wbstk TYPE wbstk,
 END OF ty_vbuk_ds,
 BEGIN OF ty_ltak_ds,
   vbeln TYPE vbeln,
  tanum TYPE tanum,
END OF ty_ltak_ds,
BEGIN OF ty_kna1_ds,
  kunnr TYPE kunnr,
  name1 TYPE name1_gp,
  counc TYPE counc,
END OF ty_kna1_ds,
 BEGIN OF ty_vbfa_ds,
   vbeln TYPE vbeln_nach,
   posnn TYPE posnr_nach,
   erdat TYPE erdat,
   erzet  TYPE erzet,
  END OF ty_vbfa_ds,
 BEGIN OF ty_likp_ds,
   vbeln TYPE vbeln_vl, "2  SD document: Delivery: Item data
   erdat TYPE erdat,    "5  Date on Which Record Was Created
   erzet TYPE erzet,
   wadat TYPE wadak,    "12 Planned goods movement date
   kunnr TYPE kunwe,    "30 Ship-to party
   werks TYPE werks,
   vkorg TYPE vkorg,
**** CHG0479115 DE3K941845 modification starts by 502237354 08/07/2014
   route TYPE route,
**** CHG0479115 DE3K941845 modification ends by 502237354 08/07/2014
   lvstk TYPE lvstk,
   wbstk TYPE wbstk,
 END OF ty_likp_ds,
BEGIN OF ty_t173t_ds,
  vsart TYPE versart,
  bezei TYPE versartbez,
  spras TYPE spras,
  END OF ty_t173t_ds,
 BEGIN OF ty_final_ds,
  fagent    TYPE string ,
  carrier   TYPE string ,
  vsart     TYPE string ,
  shiptype  TYPE string ,
  hstat     TYPE string ,
  istat     TYPE string ,
  delno     TYPE string ,
  dcreate   TYPE string ,
  goodissue TYPE string ,
  tordno    TYPE string ,
  shipto    TYPE string ,
  soldton   TYPE string ,
  scountry  TYPE string ,
  svalue    TYPE netwr_ap ,
  curr      TYPE string ,
  dlrdd     TYPE p,
  ndelines  TYPE string ,
  erzet    TYPE erzet,
  erdat    TYPE datum,
  END OF ty_final_ds,
**** CHG0479115 DE3K941845 modification starts by 502237354 08/07/2014
  BEGIN OF ty_tvro,
    route TYPE route,
    vsart TYPE VERSART,
  END OF ty_tvro,

  BEGIN OF ty_ekpo,
    ebeln TYPE ebeln,
    ebelp TYPE ebelp,
    netwr TYPE bwert,
  END OF ty_ekpo,

  BEGIN OF ty_ekko,
    ebeln TYPE ebeln,
    waers TYPE waers,
  END OF ty_ekko.
**** CHG0479115 DE3K941845 modification ends by 502237354 08/07/2014
************** Internal table
DATA :   gt_expo_ds    TYPE STANDARD TABLE OF ty_final_ds ,
         gt_dome_ds    TYPE STANDARD TABLE OF ty_final_ds ,
         gt_itc_ds     TYPE STANDARD TABLE OF ty_final_ds ,
         gt_final_ds   TYPE STANDARD TABLE OF ty_final_ds ,
         gt_likp_ds    TYPE STANDARD TABLE OF ty_likp_ds  ,
         gt_vttp_ds    TYPE STANDARD TABLE OF ty_vttp_ds  ,
         gt_lips_ds    TYPE STANDARD TABLE OF ty_lips_ds  ,
         gt_vbap_ds    TYPE STANDARD TABLE OF ty_vbap_ds  ,
         gt_vbfa_ds    TYPE STANDARD TABLE OF ty_vbfa_ds  ,
         gt_vttk_ds    TYPE STANDARD TABLE OF ty_vttk_ds  ,
         gt_vbuk_ds    TYPE STANDARD TABLE OF ty_vbuk_ds  ,
         gt_kna1_ds    TYPE STANDARD TABLE OF ty_kna1_ds  ,
         gt_ltak_ds    TYPE STANDARD TABLE OF ty_ltak_ds  ,
         gt_ltak1_ds   TYPE STANDARD TABLE OF ty_ltak_ds  ,
         gt_vbuk1_ds   TYPE STANDARD TABLE OF ty_vbuk_ds  ,
         gt_vbup_ds    TYPE STANDARD TABLE OF ty_vbup_ds  ,
         gt_vbpa_ds    TYPE STANDARD TABLE OF ty_vbpa_ds  ,
         gt_vbak_ds    TYPE STANDARD TABLE OF ty_vbak_ds  ,
         gt_knvv_ds    TYPE STANDARD TABLE OF ty_knvv_ds  ,
         gt_t173t_ds   TYPE STANDARD TABLE OF ty_t173t_ds ,
         gt_sort_ds     TYPE slis_t_sortinfo_alv,
         gt_ztuhcd1_ds  TYPE STANDARD TABLE OF ztuhcd1 ,
         gt_fldcat_ds   TYPE STANDARD TABLE OF slis_fieldcat_alv,
*******Declarations of work area
          gi_expo_ds    TYPE ty_final_ds ,
          gi_dome_ds    TYPE ty_final_ds ,
          gi_itc_ds     TYPE ty_final_ds ,
*          gi_knvv_ds    TYPE ty_knvv_ds,
          gi_t001_ds    TYPE ty_t001_ds,
          gi_t173t_ds   TYPE  ty_t173t_ds,
          gi_final_ds   TYPE ty_final_ds,
          gi_likp_ds    TYPE ty_likp_ds,
          gi_vbpa_ds    TYPE  ty_vbpa_ds,
          gi_vttp_ds    TYPE ty_vttp_ds,
          gi_vttk_ds    TYPE ty_vttk_ds,
          gi_vbuk_ds    TYPE ty_vbuk_ds,
          gi_ltak_ds    TYPE ty_ltak_ds,
          gi_ltak1_ds   TYPE ty_ltak_ds  ,
          gi_kna1_ds    TYPE ty_kna1_ds,
          gi_lips_ds    TYPE ty_lips_ds,
          gi_vbap_ds    TYPE ty_vbap_ds,
          gi_vbfa_ds    TYPE ty_vbfa_ds,
          gi_vbup_ds    TYPE ty_vbup_ds,
          gi_vbak_ds    TYPE ty_vbak_ds,
          gi_vbuk1_ds   TYPE ty_vbuk_ds,
**** CHG0479115 DE3K941845 modification starts by 502237354 08/07/2014
          gi_tvro_ds    TYPE ty_tvro,
          gt_tvro_ds    TYPE TABLE OF ty_tvro,
          gt_ekpo_ds    TYPE TABLE OF ty_ekpo,
          gi_ekpo_ds    TYPE ty_ekpo,
          gt_ekko_ds    TYPE TABLE OF ty_ekko,
          gi_ekko_ds    TYPE ty_ekko,
**** CHG0479115 DE3K941845 modification ends by 502237354 08/07/2014
          gi_ztuhcd1_ds  TYPE ztuhcd1 ,
          l_fld          TYPE slis_fieldcat_alv,
************Local variables
           no_outt          TYPE slis_fieldcat_main0-no_out,
           flag             TYPE slis_fieldcat_main0-no_out  ,
           gv_netwr2        TYPE netwr_ap,
           gv_netwr_dc      TYPE netwr_ap,
           gv_netwr_exc     TYPE netwr_ap,
           gv_netwr_itc     TYPE netwr_ap,
           gv_netwr_dc1     TYPE netwr_ap,
           gv_netwr_exc1    TYPE netwr_ap,
           gv_netwr_itc1    TYPE netwr_ap,
           gv_netwr_dc2     TYPE netwr_ap,
           gv_netwr_exc2    TYPE netwr_ap,
           gv_netwr_itc2    TYPE netwr_ap,
**** CHG0479115 DE3K942601 modification starts by 502237354 11/07/2014
           gi_oth_ds        TYPE ty_final_ds ,
           gt_oth_ds        TYPE STANDARD TABLE OF ty_final_ds ,
           gv_netwr_oth     TYPE netwr_ap,
           gv_netwr_oth1    TYPE netwr_ap,
           gv_netwr_oth2    TYPE netwr_ap,
           gv_netwr11       TYPE netwr_ap,
           gv_netwr12       TYPE netwr_ap,
           gv_netwr13       TYPE netwr_ap,
           gv_netwr_tvalue4 TYPE netwr_ap,
           gv_c19           TYPE i VALUE 0,
           gv_c20           TYPE i VALUE 0,
           gv_c21           TYPE i VALUE 0,
           gv_c22           TYPE i VALUE 0,
           gv_c23           TYPE i,
           gv_c24           TYPE i,
           gv_tot_lines4    TYPE i,
           gv_avg4          TYPE i,
**** CHG0479115 DE3K942601 modification starts by 502237354 11/07/2014
           gv_netwr3        TYPE netwr_ap,
           gv_netwr4        TYPE netwr_ap,
           gv_netwr5        TYPE netwr_ap,
           gv_netwr6        TYPE netwr_ap,
           gv_netwr7        TYPE netwr_ap,
           gv_netwr8        TYPE netwr_ap,
           gv_netwr9        TYPE netwr_ap,
           gv_netwr10       TYPE netwr_ap,
           gv_netwr_tvalue1 TYPE netwr_ap,
           gv_netwr_tvalue2 TYPE netwr_ap,
           gv_netwr_tvalue3 TYPE netwr_ap,
           gv_netwr         TYPE netwr_ap,
           gv_netwr1        TYPE netwr_ap ,
           gv_count         TYPE i VALUE 0,
           gv_c1            TYPE i VALUE 0,
           gv_c2            TYPE i VALUE 0,
           gv_c3            TYPE i VALUE 0,
           gv_c4            TYPE i VALUE 0,
           gv_c5            TYPE i,
           gv_c6            TYPE i,
           gv_c7            TYPE i VALUE 0,
           gv_c8            TYPE i VALUE 0,
           gv_c9            TYPE i VALUE 0,
           gv_c10           TYPE i VALUE 0,
           gv_c11           TYPE i,
           gv_c12           TYPE i,
           gv_c13           TYPE i VALUE 0,
           gv_c14           TYPE i VALUE 0,
           gv_c15           TYPE i VALUE 0,
           gv_c16           TYPE i VALUE 0,
           gv_c17           TYPE i,
           gv_c18           TYPE i,
           gv_erdat(20)     TYPE c,
           gv_wadat(20)     TYPE c,
           gv_tot_lines1    TYPE i,
           gv_tot_lines2    TYPE i,
           gv_tot_lines3    TYPE i,
           gv_avg1          TYPE i,
           gv_avg2          TYPE i,
           gv_avg3          TYPE i,
           gv_twcv          TYPE netwr_ap,
           gv_tlwc          TYPE i,
           gv_tcv           TYPE netwr_ap ,
           gv_tcl           TYPE i,
           gv_twcv1         TYPE netwr_ap,
           gv_tlwc1         TYPE i,
           gv_tcv1          TYPE netwr_ap ,
           gv_tcl1          TYPE i,
           gv_twcv2         TYPE netwr_ap,
           gv_tlwc2         TYPE i,
           gv_tcv2          TYPE netwr_ap ,
           gv_tcl2          TYPE i,
           gv_ttv           TYPE netwr_ap,
           gv_ttl           TYPE i ,
           gv_tavg          TYPE i,
**** CHG0479115 DE3K941845 modification starts by 502237354 08/07/2014
           gv_datecount     TYPE p,
           gv_datecount1    TYPE p.
**** CHG0479115 DE3K941845 modification ends by 502237354 08/07/2014
*************
DATA: p_waers TYPE sy-waers,
      gt_pdate TYPE datum.
***********constants declarations
CONSTANTS : gc_field_name_ds(30)   TYPE c   VALUE 'ZRMM_PICKREL',
           gc_bukrs_ds(10)         TYPE c   VALUE 'BUKRS',
           gc_parvw_ds(10)         TYPE c   VALUE 'PARVW',
           gc_flag(1)              TYPE c   VALUE  'X'.

************************************ Local Variables
DATA :    gv_w_text_400(12) TYPE c,
          gw_sociedad_tx(30) TYPE c,
          gv_l_waers TYPE t001-waers,
          gv_hora    TYPE sy-uzeit,
          gv_fecha   TYPE sy-datum.
gv_fecha = sy-datum.
gv_hora = sy-uzeit.

CONSTANTS: c_tabname(30) TYPE c VALUE 'GT_FINAL_DS'.
no_outt = 'X'.
flag = 2.

*-----------------------------------------------------------------------
* Ranges declaration
*-----------------------------------------------------------------------
RANGES: gr_kostk FOR vbuk-kostk,
        gr_wbstk FOR vbuk-wbstk.

