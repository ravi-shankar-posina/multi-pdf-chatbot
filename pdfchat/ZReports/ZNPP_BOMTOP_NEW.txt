*&---------------------------------------------------------------------*
*&  Include           ZNPP_BOMTOP_NEW
*&---------------------------------------------------------------------*
*----------------------------------------------------------------------*
*   INCLUDE ZPBOMT                                                     *
*----------------------------------------------------------------------*

TABLES:
   mara,
   marc,
   mard,
  tcspr,
  stko.
TYPES: BEGIN OF ty_mara,
  matnr TYPE matnr,
  mtart TYPE mtart,
  zzaltmn TYPE zaltmn, " Added on22.01.2016 for CHG1730762 by502277866
  END OF ty_mara,

  BEGIN OF ty_mast,
    matnr TYPE matnr,
    werks TYPE werks,
    stlan TYPE stlan,
    END OF ty_mast,

 BEGIN OF ty_mast1,
    matnr TYPE matnr,
    werks TYPE werks,
    stlan TYPE stlan,
    bmeng TYPE bmeng,
    meins TYPE meins,
    END OF ty_mast1.

DATA: BEGIN OF gi_selpool.
        INCLUDE STRUCTURE cstmat.
DATA: END OF gi_selpool,
      gt_selpool LIKE TABLE OF gi_selpool.

DATA: BEGIN OF gi_stb.
        INCLUDE STRUCTURE stpox.
DATA: END OF gi_stb,
      gt_stb LIKE TABLE OF gi_stb,
      gi_ztuhcd1 TYPE ztuhcd1,
      gt_ztuhcd1 TYPE TABLE OF ztuhcd1,
      gc_name(15) TYPE c VALUE 'ZRPP_BOMIMV_NEW',
      gc_key1(4)   TYPE c VALUE 'MTRT',
      gc_field1(5) TYPE c VALUE 'MTART'.


DATA: BEGIN OF gi_matcat.
        INCLUDE STRUCTURE cscmat.
DATA: END OF gi_matcat,
      gt_matcat LIKE TABLE OF gi_matcat.

TYPES: BEGIN OF ty_mat_list2,
        level(2),
        fgmat TYPE matnr,
        matnr TYPE matnr,
        werks TYPE werks_d,
        zoldn TYPE zlclid,
        maktx TYPE maktx,
        zzaltmn TYPE zaltmn," Added on22.01.2016 for CHG1730762 by502277866
        quant(17),
        quantcntd TYPE bmeng,
        meins TYPE meins,
        meins1 TYPE meins,
        lgort TYPE lgort_d,
        schgt TYPE schgt,
        lgpbe TYPE lgpbe,
        beskz TYPE beskz,
        wegxx TYPE wegxx,
        posnr TYPE posnr,
        stlty TYPE stlty,
        stlnr TYPE stnum,
        stlkn TYPE stlkn,
        stpoz TYPE cim_count,
        msign TYPE cs_e_msign,
        rgekz TYPE rgekz,
        mmein TYPE meins,
        bmeng TYPE bmeng,
        stlkz TYPE stlkz,
        kstnr TYPE cs_kstnr,
        xtlnr TYPE cs_e_xstnr,
        stlan TYPE stlan,
        mschg TYPE cs_e_mschg,
        bindc TYPE schgt,
        aenam TYPE annam,
        aedat TYPE aedat,
        ausch TYPE ausch,
        mnglg TYPE string,
        mngko TYPE cs_e_mngko,
        kausf TYPE string,
        idnrk TYPE idnrk,
        menge TYPE string,
        kzkup TYPE kzkup,
        sakto TYPE sakto,
        kstpz TYPE cs_kstpz,
        annam TYPE annam,
        andat TYPE andat,
        waers TYPE waers,
        lkenz TYPE lkenz,
        umren TYPE string,
        xloek TYPE xloek,
        loekz TYPE loekz,
        doknr TYPE doknr,
        dokar TYPE dokar,
        stufe TYPE string,
        dspst TYPE cs_dispo,
        fmeng TYPE fmeng,
        webaz TYPE string,
        sbdkz TYPE sbdkz,
        pswrk TYPE pswrk,
        postp TYPE postp,
        potx2 TYPE potx2,
        matkl TYPE matkl,
        mtart TYPE mtart,
        dismm TYPE dismm,
        umrez TYPE string,
        ojtxb TYPE ojtxb,
        dumps TYPE dumps,
        mmsta TYPE mmsta,
        preis TYPE string,
        vprsv TYPE vprsv,
        peinh TYPE string,
        preih TYPE preih,
        fbskz TYPE fbskz,
        prvbe TYPE prvbe,
        prctr TYPE prctr,
        ekorg TYPE ekorg,
        ekgrp TYPE ekgrp,
        sanka TYPE sanka,
        amglg TYPE string,
        sortf TYPE sortp,
        itsob TYPE cs_sobmx,
        stprs TYPE string,
        kzwsm TYPE kzwso,
        datuv TYPE datuv,
        datub TYPE datub,
        lifnr TYPE lifnr,
        mstae TYPE mstae,
        END OF ty_mat_list2.

TYPES: BEGIN OF ty_title,
        title(2235) TYPE c,
       END OF ty_title.
DATA:  gi_mat_list2 TYPE ty_mat_list2,
       gt_mat_list2 TYPE TABLE OF ty_mat_list2,
       gi_mat_list3 TYPE ty_mat_list2,
       gt_mat_list3 TYPE TABLE OF ty_mat_list2.

TYPES: BEGIN OF ty_mard ,
      matnr TYPE matnr,
      werks TYPE werks_d,
      lgort TYPE lgort_d,
      labst TYPE labst,
      lgpbe TYPE lgpbe,
      END OF ty_mard.
DATA: gi_mard TYPE ty_mard,
      gt_mard TYPE TABLE OF ty_mard.

TYPES: BEGIN OF ty_marc,
      matnr TYPE matnr,
      werks TYPE werks_d,
      beskz TYPE beskz,
      schgt TYPE schgt,
      zoldn TYPE zlclid,
      END OF ty_marc.
DATA: gi_marc TYPE ty_marc,
      gt_marc TYPE TABLE OF ty_marc,
      gt_marc1 TYPE TABLE OF ty_marc.

DATA:
      pm_altvo(1)   TYPE c,
      pm_ausch(1)   TYPE c,
      pm_bagrp TYPE matnr,
      pm_beikz(1)   TYPE c,
      pm_bessl(1)   TYPE c,
      pm_brems(1)   TYPE c,
      pm_erskz(1)   TYPE c,
      pm_erssl(1)   TYPE c,
      mem_mngmt(1) TYPE c,
      pm_postp(1)   TYPE c,
      pm_sanko TYPE sanko,
      pm_sanfe TYPE sanfe,
      pm_sanka TYPE sanka,
      pm_sanin TYPE sanin,
      pm_sanvs TYPE sanvs,
      pm_rvrel TYPE rvrel,
      pm_schgt TYPE schgt,
      pm_stkkz TYPE stkkz,
      pm_stlal TYPE stlal,
      pm_ehndl(1)       TYPE c VALUE '1',
      gt_mara TYPE TABLE OF ty_mara,
      gi_mara TYPE ty_mara,
      gt_fieldc TYPE slis_t_fieldcat_alv,
      gw_layout_ds TYPE slis_layout_alv,
      gw_filename  TYPE string,
      gt_title TYPE STANDARD TABLE OF ty_title,
      gi_title TYPE ty_title,
      gt_mast TYPE TABLE OF ty_mast,
      gt_mast1 TYPE TABLE OF ty_mast1,
      gi_mast1 TYPE ty_mast1,
      gi_mast TYPE ty_mast.
TYPES : BEGIN OF ty_upload,
        matnr  TYPE matnr ,
        werks TYPE werks_d,
        qty   TYPE char13 ,
        meins TYPE char2,
       END OF ty_upload.
DATA : gt_upload TYPE TABLE OF ty_upload,
       gi_upload TYPE ty_upload.
*----------------------------------------------------------------------*
*   CONSTANTS                                                          *
*----------------------------------------------------------------------*
DATA:
      gc_mat_list3(12) TYPE c VALUE 'GT_MAT_LIST3',
      gc_msign(5) TYPE c VALUE 'MSIGN',
      gc_stkkz(5) TYPE c VALUE 'STLKZ',
      gc_kstnr(5) TYPE c VALUE 'KSTNR',
      gc_xtlnr(5) TYPE c VALUE 'XTLNR',
      gc_stlan(5) TYPE c VALUE 'STLAN',
      gc_mschg(5) TYPE c VALUE 'MSCHG',
      gc_bindc(5) TYPE c VALUE 'BINDC',
      gc_annam(5) TYPE c VALUE 'ANNAM',
      gc_aedat(5) TYPE c VALUE 'AEDAT',
      gc_ausch(5) TYPE c VALUE 'AUSCH',
      gc_mnglg(5) TYPE c VALUE 'MNGLG',
      gc_kausf(5) TYPE c VALUE 'KAUSF',
      gc_idnrk(5) TYPE c VALUE 'IDNRK',
      gc_menge(5) TYPE c VALUE 'MENGE',
      gc_kzkup(5) TYPE c VALUE 'KZKUP',
      gc_sakto(5) TYPE c VALUE 'SAKTO',
      gc_aenam(5) TYPE c VALUE 'AENAM',
      gc_andat(5) TYPE c VALUE 'ANDAT',
      gc_waers(5) TYPE c VALUE 'WAERS',
      gc_umren(5) TYPE c VALUE 'UMREN',
      gc_xloek(5) TYPE c VALUE 'XLOEK',
      gc_loekz(5) TYPE c VALUE 'LOEKZ',
      gc_doknr(5) TYPE c VALUE 'DOKNR',
      gc_dokar(5) TYPE c VALUE 'DOKAR',
      gc_stufe(5) TYPE c VALUE 'STUFE',
      gc_dspst(5) TYPE c VALUE 'DSPST',
      gc_fmeng(5) TYPE c VALUE 'FMENG',
      gc_webaz(5) TYPE c VALUE 'WEBAZ',
      gc_sbdkz(5) TYPE c VALUE 'SBDKZ',
      gc_pswrk(5) TYPE c VALUE 'PSWRK',
      gc_postp(5) TYPE c VALUE 'POSTP',
      gc_potx2(5) TYPE c VALUE 'POTX2',
      gc_matkl(5) TYPE c VALUE 'MATKL',
      gc_mtart(5) TYPE c VALUE 'MTART',
      gc_dismm(5) TYPE c VALUE 'DISMM',
      gc_umrez(5) TYPE c VALUE 'UMREZ',
      gc_ojtxb(5) TYPE c VALUE 'OJTXB',
      gc_dumps(5) TYPE c VALUE 'DUMPS',
      gc_mmsta(5) TYPE c VALUE 'MMSTA',
      gc_preis(5) TYPE c VALUE 'PREIS',
      gc_vprsv(5) TYPE c VALUE 'VPRSV',
      gc_peinh(5) TYPE c VALUE 'PEINH',
      gc_preih(5) TYPE c VALUE 'PREIH',
      gc_fbskz(5) TYPE c VALUE 'FBSKZ',
      gc_prvbe(5) TYPE c VALUE 'PRVBE',
      gc_prctr(5) TYPE c VALUE 'PRCTR',
      gc_ekorg(5) TYPE c VALUE 'EKORG',
      gc_ekgrp(5) TYPE c VALUE 'EKGRP',
      gc_sanka(5) TYPE c VALUE 'SANKA',
      gc_amglg(5) TYPE c VALUE 'AMGLG',
      gc_sortf(5) TYPE c VALUE 'SORTF',
      gc_itsob(5) TYPE c VALUE 'ITSOB',
      gc_stprs(5) TYPE c VALUE 'STPRS',
      gc_mmein(5) TYPE c VALUE 'MMEIN',
      gc_kzwsm(5) TYPE c VALUE 'KZWSM',
      gc_datuv(5) TYPE c VALUE 'DATUV',
      gc_datub(5) TYPE c VALUE 'DATUB',
      gc_lifnr(5) TYPE c VALUE 'LIFNR',
      gc_mstae(5) TYPE c VALUE 'MSTAE',
      gc_level(5) TYPE c VALUE 'LEVEL',
      gc_matnr(5) TYPE c VALUE 'MATNR',
      gc_werks(5) TYPE c VALUE 'WERKS',
      gc_zoldn(5) TYPE c VALUE 'ZOLDN',
      gc_lgort(5) TYPE c VALUE 'LGORT',
      gc_schgt(5) TYPE c VALUE 'SCHGT',
      gc_lgpbe(5) TYPE c VALUE 'LGPBE',
      gc_maktx(5) TYPE c VALUE 'MAKTX',
      gc_quant(5) TYPE c VALUE 'QUANT',
      gc_meins(5) TYPE c VALUE 'MEINS',
      gc_potx1(5) TYPE c VALUE 'POTX1',
      gc_posnr(5) TYPE c VALUE 'POSNR',
      gw_filename1  TYPE string,
      gc_fname1 VALUE '_',
      gc_rep_name(15) VALUE '/REPORTS/',
      gc_rep_name1(15) VALUE '/ACTIVE',
      gc_fname2(4) VALUE '.XLS',
      gc_fname(20) VALUE '/ZPP018_',
      gc_fgmat(5) VALUE 'FGMAT'.

